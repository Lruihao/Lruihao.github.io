"use strict";var FontInspector=function e(){var t,n;var a=false;var r="data-font-name";function i(){var e=document.querySelectorAll("div["+r+"]");for(var t=0,n=e.length;t<n;++t){var a=e[t];a.className=""}}function l(){var e=document.querySelectorAll("div["+r+"]");for(var t=0,n=e.length;t<n;++t){var a=e[t];a.className="debuggerHideText"}}function d(e,t){var n=document.querySelectorAll("div["+r+"="+e+"]");for(var a=0,i=n.length;a<i;++a){var l=n[a];l.className=t?"debuggerShowText":"debuggerHideText"}}function o(e){if(!e.target.dataset.fontName||e.target.tagName.toUpperCase()!=="DIV"){return}var t=e.target.dataset.fontName;var n=document.getElementsByTagName("input");for(var a=0;a<n.length;++a){var r=n[a];if(r.dataset.fontName!==t){continue}r.checked=!r.checked;d(t,r.checked);r.scrollIntoView()}}return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function e(a){var r=this.panel;r.setAttribute("style","padding: 5px;");var i=document.createElement("button");i.addEventListener("click",l);i.textContent="Refresh";r.appendChild(i);t=document.createElement("div");r.appendChild(t);n=a.createObjectURL},cleanup:function e(){t.textContent=""},enabled:false,get active(){return a},set active(e){a=e;if(a){document.body.addEventListener("click",o,true);l()}else{document.body.removeEventListener("click",o,true);i()}},fontAdded:function e(a,r){function i(e,t){var n=document.createElement("table");for(var a=0;a<t.length;a++){var r=document.createElement("tr");var i=document.createElement("td");i.textContent=t[a];r.appendChild(i);var l=document.createElement("td");l.textContent=e[t[a]].toString();r.appendChild(l);n.appendChild(r)}return n}var o=i(a,["name","type"]);var s=a.loadedName;var p=document.createElement("div");var c=document.createElement("span");c.textContent=s;var u=document.createElement("a");if(r){r=/url\(['"]?([^\)"']+)/.exec(r);u.href=r[1]}else if(a.data){u.href=n(a.data,a.mimeType)}u.textContent="Download";var h=document.createElement("a");h.href="";h.textContent="Log";h.addEventListener("click",function(e){e.preventDefault();console.log(a)});var v=document.createElement("input");v.setAttribute("type","checkbox");v.dataset.fontName=s;v.addEventListener("click",function(e,t){return function(){d(t,e.checked)}}(v,s));p.appendChild(v);p.appendChild(c);p.appendChild(document.createTextNode(" "));p.appendChild(u);p.appendChild(document.createTextNode(" "));p.appendChild(h);p.appendChild(o);t.appendChild(p);setTimeout(()=>{if(this.active){l()}},2e3)}}}();var opMap;var StepperManager=function e(){var t=[];var n=null;var a=null;var r=null;var i=Object.create(null);return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function e(t){var l=this;this.panel.setAttribute("style","padding: 5px;");a=document.createElement("div");r=document.createElement("select");r.addEventListener("change",function(e){l.selectStepper(this.value)});a.appendChild(r);n=document.createElement("div");this.panel.appendChild(a);this.panel.appendChild(n);if(sessionStorage.getItem("pdfjsBreakPoints")){i=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints"))}opMap=Object.create(null);for(var d in t.OPS){opMap[t.OPS[d]]=d}},cleanup:function e(){r.textContent="";n.textContent="";t=[]},enabled:false,active:false,create:function e(a){var l=document.createElement("div");l.id="stepper"+a;l.setAttribute("hidden",true);l.className="stepper";n.appendChild(l);var d=document.createElement("option");d.textContent="Page "+(a+1);d.value=a;r.appendChild(d);var o=i[a]||[];var s=new Stepper(l,a,o);t.push(s);if(t.length===1){this.selectStepper(a,false)}return s},selectStepper:function e(n,a){var i;n=n|0;if(a){this.manager.selectPanel(this)}for(i=0;i<t.length;++i){var l=t[i];if(l.pageIndex===n){l.panel.removeAttribute("hidden")}else{l.panel.setAttribute("hidden",true)}}var d=r.options;for(i=0;i<d.length;++i){var o=d[i];o.selected=(o.value|0)===n}},saveBreakPoints:function e(t,n){i[t]=n;sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(i))}}}();var Stepper=function e(){function t(e,t){var n=document.createElement(e);if(t){n.textContent=t}return n}function n(e){if(typeof e==="string"){var t=75;return e.length<=t?e:e.substring(0,t)+"..."}if(typeof e!=="object"||e===null){return e}if("length"in e){var a=[],r,i;var l=10;for(r=0,i=Math.min(l,e.length);r<i;r++){a.push(n(e[r]))}if(r<e.length){a.push("...")}return a}var d={};for(var o in e){d[o]=n(e[o])}return d}function a(e,t,n){this.panel=e;this.breakPoint=0;this.nextBreakPoint=null;this.pageIndex=t;this.breakPoints=n;this.currentIdx=-1;this.operatorListIdx=0}a.prototype={init:function e(n){var a=this.panel;var r=t("div","c=continue, s=step");var i=t("table");r.appendChild(i);i.cellSpacing=0;var l=t("tr");i.appendChild(l);l.appendChild(t("th","Break"));l.appendChild(t("th","Idx"));l.appendChild(t("th","fn"));l.appendChild(t("th","args"));a.appendChild(r);this.table=i;this.updateOperatorList(n)},updateOperatorList:function e(a){var r=this;function i(){var e=+this.dataset.idx;if(this.checked){r.breakPoints.push(e)}else{r.breakPoints.splice(r.breakPoints.indexOf(e),1)}StepperManager.saveBreakPoints(r.pageIndex,r.breakPoints)}var l=15e3;if(this.operatorListIdx>l){return}var d=document.createDocumentFragment();var o=Math.min(l,a.fnArray.length);for(var s=this.operatorListIdx;s<o;s++){var p=t("tr");p.className="line";p.dataset.idx=s;d.appendChild(p);var c=this.breakPoints.includes(s);var u=a.argsArray[s]||[];var h=t("td");var v=t("input");v.type="checkbox";v.className="points";v.checked=c;v.dataset.idx=s;v.onclick=i;h.appendChild(v);p.appendChild(h);p.appendChild(t("td",s.toString()));var f=opMap[a.fnArray[s]];var m=u;if(f==="showText"){var g=u[0];var C=[];var b=[];for(var x=0;x<g.length;x++){var k=g[x];if(typeof k==="object"&&k!==null){b.push(k.fontChar)}else{if(b.length>0){C.push(b.join(""));b=[]}C.push(k)}}if(b.length>0){C.push(b.join(""))}m=[C]}p.appendChild(t("td",f));p.appendChild(t("td",JSON.stringify(n(m))))}if(o<a.fnArray.length){p=t("tr");var E=t("td","...");E.colspan=4;d.appendChild(E)}this.operatorListIdx=a.fnArray.length;this.table.appendChild(d)},getNextBreakPoint:function e(){this.breakPoints.sort(function(e,t){return e-t});for(var t=0;t<this.breakPoints.length;t++){if(this.breakPoints[t]>this.currentIdx){return this.breakPoints[t]}}return null},breakIt:function e(t,n){StepperManager.selectStepper(this.pageIndex,true);var a=this;var r=document;a.currentIdx=t;var i=function(e){switch(e.keyCode){case 83:r.removeEventListener("keydown",i);a.nextBreakPoint=a.currentIdx+1;a.goTo(-1);n();break;case 67:r.removeEventListener("keydown",i);var t=a.getNextBreakPoint();a.nextBreakPoint=t;a.goTo(-1);n();break}};r.addEventListener("keydown",i);a.goTo(t)},goTo:function e(t){var n=this.panel.getElementsByClassName("line");for(var a=0,r=n.length;a<r;++a){var i=n[a];if((i.dataset.idx|0)===t){i.style.backgroundColor="rgb(251,250,207)";i.scrollIntoView()}else{i.style.backgroundColor=null}}}};return a}();var Stats=function e(){var t=[];function n(e){while(e.hasChildNodes()){e.removeChild(e.lastChild)}}function a(e){for(var n=0,a=t.length;n<a;++n){if(t[n].pageNumber===e){return n}}return false}return{id:"Stats",name:"Stats",panel:null,manager:null,init(e){this.panel.setAttribute("style","padding: 5px;")},enabled:false,active:false,add(e,r){if(!r){return}var i=a(e);if(i!==false){var l=t[i];this.panel.removeChild(l.div);t.splice(i,1)}var d=document.createElement("div");d.className="stats";var o=document.createElement("div");o.className="title";o.textContent="Page: "+e;var s=document.createElement("div");s.textContent=r.toString();d.appendChild(o);d.appendChild(s);t.push({pageNumber:e,div:d});t.sort(function(e,t){return e.pageNumber-t.pageNumber});n(this.panel);for(var p=0,c=t.length;p<c;++p){this.panel.appendChild(t[p].div)}},cleanup(){t=[];n(this.panel)}}}();window.PDFBug=function e(){var t=300;var n=[];var a=null;return{tools:[FontInspector,StepperManager,Stats],enable(e){var t=false,n=this.tools;if(e.length===1&&e[0]==="all"){t=true}for(var a=0;a<n.length;++a){var r=n[a];if(t||e.includes(r.id)){r.enabled=true}}if(!t){n.sort(function(t,a){var r=e.indexOf(t.id);r=r<0?n.length:r;var i=e.indexOf(a.id);i=i<0?n.length:i;return r-i})}},init(e,a){var r=document.createElement("div");r.id="PDFBug";var i=document.createElement("div");i.setAttribute("class","controls");r.appendChild(i);var l=document.createElement("div");l.setAttribute("class","panels");r.appendChild(l);a.appendChild(r);a.style.right=t+"px";var d=this.tools;var o=this;for(var s=0;s<d.length;++s){var p=d[s];var c=document.createElement("div");var u=document.createElement("button");u.textContent=p.name;u.addEventListener("click",function(e){return function(t){t.preventDefault();o.selectPanel(e)}}(s));i.appendChild(u);l.appendChild(c);p.panel=c;p.manager=this;if(p.enabled){p.init(e)}else{c.textContent=p.name+" is disabled. To enable add "+' "'+p.id+'" to the pdfBug parameter '+"and refresh (separate multiple by commas)."}n.push(u)}this.selectPanel(0)},cleanup(){for(var e=0,t=this.tools.length;e<t;e++){if(this.tools[e].enabled){this.tools[e].cleanup()}}},selectPanel(e){if(typeof e!=="number"){e=this.tools.indexOf(e)}if(e===a){return}a=e;var t=this.tools;for(var r=0;r<t.length;++r){if(r===e){n[r].setAttribute("class","active");t[r].active=true;t[r].panel.removeAttribute("hidden")}else{n[r].setAttribute("class","");t[r].active=false;t[r].panel.setAttribute("hidden","true")}}}}}();